<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ¦ LAST - Ø§Ù„Ù…Ù„ÙŠÙˆÙ† Ø§Ù„Ø£Ø®ÙŠØ±</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: Arial, sans-serif; overflow: hidden; background: #000; touch-action: none; }

        /* Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø§ÙØªØªØ§Ø­ÙŠØ© */
        #splash { position: fixed; inset: 0; background: linear-gradient(135deg, #1a1a2e 0%, #0f3460 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; transition: opacity 0.5s; }
        #splash.hide { opacity: 0; pointer-events: none; }
        .splash-logo { font-size: 10em; animation: bounce 1.5s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-30px); } }
        .splash-title { font-size: 2.5em; color: #ffd700; margin: 20px 0; text-shadow: 0 0 20px rgba(255,215,0,0.6); }
        .start-btn { padding: 18px 50px; font-size: 1.5em; background: #ffd700; color: #000; border: none; border-radius: 50px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .start-btn:active { transform: scale(0.9); }

        /* Ø¹Ø§Ù„Ù… Ø§Ù„Ù„Ø¹Ø¨Ø© */
        #game { position: fixed; inset: 0; display: none; }
        #game.active { display: block; }
        /* ØªØ¹Ø¯ÙŠÙ„: Ø¬Ø¹Ù„ Ø§Ù„Ø£Ø±Ø¶ÙŠØ© ÙƒÙ„Ù‡Ø§ Ø£Ø´Ø¬Ø§Ø± Ø¹Ø¨Ø± Ø§Ù„Ø®Ù„ÙÙŠØ© */
        #world { position: absolute; width: 300vw; height: 300vh; background: #1a5f1a; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"><text y="40" font-size="35">ğŸŒ³</text></svg>'); background-size: 100px 100px; transition: transform 0.1s ease-out; }

        /* Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙˆØ§Ù„Ø¹Ù†Ø§ØµØ± */
        #player { position: absolute; width: 80px; height: 80px; font-size: 4em; display: flex; align-items: center; justify-content: center; z-index: 100; transition: transform 0.1s; }
        #player.walk { animation: walk 0.3s infinite; }
        @keyframes walk { 0% { transform: rotate(-5deg); } 50% { transform: rotate(5deg); } 100% { transform: rotate(-5deg); } }
        
        .item { position: absolute; font-size: 3em; cursor: pointer; user-select: none; }
        .lake { position: absolute; width: 400px; height: 300px; background: rgba(30,144,255,0.4); border-radius: 50%; box-shadow: inset 0 0 50px rgba(0,0,0,0.2); }
        .tree { position: absolute; font-size: 4em; opacity: 0.8; }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
        #hud { position: fixed; top: 10px; left: 10px; right: 10px; display: flex; justify-content: space-between; z-index: 1000; pointer-events: none; }
        .stat { background: rgba(0,0,0,0.7); color: #ffd700; padding: 10px 15px; border-radius: 15px; border: 1px solid #ffd700; font-weight: bold; pointer-events: auto; }
        
        #progress { position: fixed; bottom: 120px; left: 50%; transform: translateX(-50%); width: 250px; height: 25px; background: #222; border-radius: 10px; display: none; border: 2px solid #fff; overflow: hidden; }
        #progress-bar { height: 100%; width: 0%; background: #4caf50; transition: width 0.1s; }

        #msg { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.9); color: #fff; padding: 20px; border-radius: 15px; text-align: center; display: none; z-index: 2000; border: 2px solid #ffd700; }
        #warn { position: fixed; top: 80px; left: 50%; transform: translateX(-50%); background: red; color: white; padding: 10px 20px; border-radius: 10px; display: none; z-index: 2000; font-weight: bold; }
        #hunter { position: absolute; font-size: 4em; z-index: 90; transition: all 0.5s; }

        /* Ø§Ù„Ù…ØªØ¬Ø± */
        #shop-ui { position: fixed; bottom: 20px; right: 20px; background: gold; color: black; padding: 10px; border-radius: 10px; font-weight: bold; cursor: pointer; z-index: 3000; }
    </style>
</head>
<body>

    <div id="splash">
        <div class="splash-logo">ğŸ¦</div>
        <h1 class="splash-title">Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ù„ÙŠÙˆÙ† Ø§Ù„Ø£Ø®ÙŠØ±</h1>
        <button class="start-btn" onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø­Ù„Ø©</button>
    </div>

    <div id="game">
        <div id="world">
            <div id="player">ğŸ¦</div> <div id="hunter">ğŸ¯</div>
        </div>
        <div id="shop-ui" onclick="openShop()">ğŸ›’ Ø§Ù„Ù…ØªØ¬Ø±</div>
        <div id="hud">
            <div class="stat">âš›ï¸ <span id="zaar">0</span></div>
            <div class="stat">ğŸ’ <span id="last">0.00</span></div>
            <div class="stat">ğŸ“Š Lvl: <span id="lvl">1</span></div>
            <div class="stat" onclick="saveGame()">ğŸ’¾ Ø­ÙØ¸</div>
        </div>
        <div id="progress"><div id="progress-bar"></div></div>
        <div id="msg"></div>
        <div id="warn">ğŸš¨ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ© ØªØ·Ø§Ø±Ø¯Ùƒ!</div>
    </div>

    <script>
        const state = { 
            x: 150, y: 150, zaar: 0, last: 0, lvl: 1, 
            isDragging: false, isDigging: false, hunterActive: true,
            hx: 280, hy: 280 // Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØµÙŠØ§Ø¯ (Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ©)
        };

        const E = {
            world: document.getElementById('world'),
            player: document.getElementById('player'),
            hunter: document.getElementById('hunter'),
            zaar: document.getElementById('zaar'),
            last: document.getElementById('last'),
            lvl: document.getElementById('lvl'),
            msg: document.getElementById('msg'),
            warn: document.getElementById('warn'),
            bar: document.getElementById('progress-bar'),
            prog: document.getElementById('progress')
        };

        // Ø£ØµÙˆØ§Øª Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†
        const sounds = {
            dig: new Audio('https://assets.mixkit.co/sfx/preview/mixkit-digging-in-the-dirt-609.mp3'),
            alert: new Audio('https://assets.mixkit.co/sfx/preview/mixkit-security-facility-breach-699.mp3')
        };

        function startGame() {
            loadGame(); // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
            document.getElementById('splash').classList.add('hide');
            document.getElementById('game').classList.add('active');
            initWorld();
            requestAnimationFrame(gameLoop);
        }

        function initWorld() {
            // Ø§Ù„Ø£Ø±Ø¶ÙŠØ© Ù…Ù„ÙŠØ¦Ø© Ø¨Ø§Ù„Ø£Ø´Ø¬Ø§Ø± (Ø¹Ø¨Ø± Ø§Ù„Ø®Ù„ÙÙŠØ© ÙÙŠ CSS)
            for(let i=0; i<5; i++) createEl('', 'lake');
            for(let i=0; i<15; i++) createEl('ğŸ“¦', 'item treasure', true);
            updatePlayerPos();
        }

        function createEl(txt, cls, click = false) {
            const el = document.createElement('div');
            el.className = cls;
            el.textContent = txt;
            const x = Math.random() * 280 + 10;
            const y = Math.random() * 280 + 10;
            el.style.left = x + '%';
            el.style.top = y + '%';
            if(click) el.onclick = () => handleInteraction(x, y, el);
            E.world.appendChild(el);
        }

        document.addEventListener('touchmove', (e) => {
            if (state.isDigging) return;
            const touch = e.touches[0];
            state.x = (touch.pageX / window.innerWidth) * 100 * 3;
            state.y = (touch.pageY / window.innerHeight) * 100 * 3;
            updatePlayerPos();
        });

        function updatePlayerPos() {
            E.player.style.left = state.x + '%';
            E.player.style.top = state.y + '%';
        }

        function handleInteraction(ex, ey, el) {
            const d = Math.sqrt((state.x - ex)**2 + (state.y - ey)**2);
            if (d < 20) startDigging(el);
            else showMsg("Ø§Ù‚ØªØ±Ø¨ Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚!");
        }

        // Ù†Ø¸Ø§Ù… Ø§Ù„Ø­ÙØ± Ø§Ù„Ù…Ø·ÙˆØ± - 15 Ø«Ø§Ù†ÙŠØ© Ùˆ 4 Ù…Ø±Ø§Ø­Ù„
        function startDigging(el) {
            if(state.isDigging) return;
            state.isDigging = true;
            E.prog.style.display = 'block';
            sounds.dig.play();
            
            let p = 0;
            const stages = [
                "Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ù†Ø¨Ø´ Ø§Ù„ØªØ±Ø¨Ø©...",
                "Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: ØªØ¹Ù…ÙŠÙ‚ Ø§Ù„Ø­ÙØ±Ø©...",
                "Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: ÙƒØ³Ø± Ø§Ù„ØºØ·Ø§Ø¡...",
                "Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ÙƒÙ†Ø²!"
            ];

            const inv = setInterval(() => {
                p += (100 / 150); // Ù„ÙƒÙŠ ÙŠØµÙ„ Ù„Ù€ 100 ÙÙŠ 15 Ø«Ø§Ù†ÙŠØ© (Ø¨Ø§Ø¹ØªØ¨Ø§Ø± Ø§Ù„ØªÙƒØ±Ø§Ø± ÙƒÙ„ 100ms)
                E.bar.style.width = p + '%';
                
                // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø§Ù„Ù…Ø±Ø§Ø­Ù„
                if (p < 25) E.msg.textContent = stages[0];
                else if (p < 50) E.msg.textContent = stages[1];
                else if (p < 75) E.msg.textContent = stages[2];
                else E.msg.textContent = stages[3];
                E.msg.style.display = 'block';

                if(p >= 100) {
                    clearInterval(inv);
                    state.isDigging = false;
                    E.prog.style.display = 'none';
                    E.msg.style.display = 'none';
                    state.zaar += 50;
                    E.zaar.textContent = state.zaar;
                    el.remove();
                    showMsg("ØªÙ… Ø§Ù„Ø­ÙØ± Ø¨Ù†Ø¬Ø§Ø­! +50 Ø²Ø§Ø± âš›ï¸");
                }
            }, 100);
        }

        // Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙŠØ§Ø¯ (Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ©)
        function updateHunter() {
            if(!state.hunterActive) return;
            const dx = state.x - state.hx;
            const dy = state.y - state.hy;
            state.hx += dx * 0.005;
            state.hy += dy * 0.005;
            E.hunter.style.left = state.hx + '%';
            E.hunter.style.top = state.hy + '%';

            const dist = Math.sqrt(dx*dx + dy*dy);
            if(dist < 15) {
                E.warn.style.display = 'block';
                if(!sounds.alert.playing) sounds.alert.play();
            } else {
                E.warn.style.display = 'none';
            }
        }

        function openShop() {
            showMsg("Ø§Ù„Ù…ØªØ¬Ø±: Ù‚Ø±ÙŠØ¨Ø§Ù‹ - Ø´Ø±Ø§Ø¡ Ø¯Ø±Ø¹ Ø§Ù„ØªØ®ÙÙŠ Ø¨Ù€ 500 Ø²Ø§Ø±");
        }

        function saveGame() {
            localStorage.setItem('lion_save', JSON.stringify(state));
            showMsg("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ØºØ§Ù…Ø±Ø© Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†! ğŸ’¾");
        }

        function loadGame() {
            const saved = localStorage.getItem('lion_save');
            if(saved) {
                const data = JSON.parse(saved);
                state.zaar = data.zaar;
                state.lvl = data.lvl;
                E.zaar.textContent = state.zaar;
                E.lvl.textContent = state.lvl;
            }
        }

        function showMsg(txt) {
            E.msg.textContent = txt;
            E.msg.style.display = 'block';
            setTimeout(() => E.msg.style.display = 'none', 3000);
        }

        let camX = 0, camY = 0;
        function gameLoop() {
            const targetX = -(state.x * window.innerWidth / 100 - window.innerWidth / 2);
            const targetY = -(state.y * window.innerHeight / 100 - window.innerHeight / 2);
            camX += (targetX - camX) * 0.1;
            camY += (targetY - camY) * 0.1;
            E.world.style.transform = `translate(${camX}px, ${camY}px)`;
            
            updateHunter(); // ØªØ´ØºÙŠÙ„ Ø­Ø±ÙƒØ© Ø§Ù„ØµÙŠØ§Ø¯ Ø§Ù„Ø°ÙƒÙŠØ©
            requestAnimationFrame(gameLoop);
        }
    </script>
</body>
</html>
