<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>LAST$ - العرين</title>
    <style>
        /* جو الغابة المظلمة */
        body { margin: 0; background: #050a05; color: #d4af37; font-family: 'Cairo', sans-serif; overflow: hidden; }
        
        #game-container { position: relative; width: 100vw; height: 100vh; background: radial-gradient(circle, #0a1a0a 0%, #000 100%); }

        /* البومة (المعلم) */
        .owl-message { 
            position: absolute; top: 10%; width: 80%; left: 10%; 
            background: rgba(0,0,0,0.8); border: 1px solid #d4af37; 
            padding: 15px; border-radius: 10px; z-index: 20; 
            display: none; text-align: center; font-size: 14px;
        }

        /* الشبل العاري */
        #shibl {
            position: absolute; bottom: 20%; left: 50%;
            transform: translateX(-50%); width: 150px;
            filter: grayscale(0.5); /* عاري وتايه */
            transition: 0.2s; z-index: 10;
        }

        /* الزار (الغبار) */
        .zar-counter { position: absolute; top: 20px; right: 20px; font-size: 20px; font-weight: bold; }

        /* شريط النَفَس (التعدين) */
        .progress-bar {
            position: absolute; bottom: 10%; width: 80%; left: 10%;
            height: 10px; background: #222; border-radius: 5px; overflow: hidden;
        }
        #fill { width: 0%; height: 100%; background: linear-gradient(90deg, #d4af37, #ffd700); }

        /* تأثير الظلام */
        .fog { position: absolute; width: 100%; height: 100%; background: url('https://www.transparenttextures.com/patterns/asfalt-dark.png'); opacity: 0.3; pointer-events: none; }
    </style>
</head>
<body>

<div id="game-container">
    <div class="fog"></div>
    <div class="zar-counter">الزار: <span id="zar-val">0</span></div>
    
    <div id="owl-ui" class="owl-message">
        <strong style="color: #fff;">البومة:</strong> <span id="owl-text"></span>
    </div>

    <img id="shibl" src="https://via.placeholder.com/150/8b4513/ffffff?text=SHIBL" alt="الشبل">

    <div class="progress-bar"><div id="fill"></div></div>
</div>

<script>
    const owlMessages = [
        "لا تقلق يا صغيري.. الغابة مظلمة لكن الزار في كل مكان.",
        "احفر هنا.. الصياد بعيد حالياً، اجمع ما يكفيك لتكبر."
    ];

    let zar = parseInt(localStorage.getItem('zar_balance')) || 0;
    let isDigging = false;
    let progress = 0;

    // تشغيل رسالة البومة عند الدخول
    window.onload = () => {
        const ui = document.getElementById('owl-ui');
        const text = document.getElementById('owl-text');
        ui.style.display = 'block';
        text.innerText = owlMessages[0];
        document.getElementById('zar-val').innerText = zar;
    };

    // ميكانيكا الحفر بالسحب (Drag)
    let startX = 0;
    document.addEventListener('touchstart', (e) => { startX = e.touches[0].clientX; });

    document.addEventListener('touchmove', (e) => {
        let move = Math.abs(e.touches[0].clientX - startX);
        if (move > 20) { // لو في حركة سحب
            dig();
            document.getElementById('shibl').style.transform = `translateX(-50%) scale(1.05) rotate(${Math.sin(Date.now()/100)*5}deg)`;
        }
    });

    function dig() {
        if (progress < 100) {
            progress += 0.5; // سرعة الحفر (15 ثانية تقريباً)
            document.getElementById('fill').style.width = progress + "%";
        } else {
            completeDigging();
        }
    }

    function completeDigging() {
        progress = 0;
        document.getElementById('fill').style.width = "0%";
        zar += 10;
        localStorage.setItem('zar_balance', zar);
        document.getElementById('zar-val').innerText = zar;
        
        // رسالة نجاح من البومة
        document.getElementById('owl-text').innerText = "أحسنت! هذا الزار سيبنيك.. استمر.";
    }
</script>

</body>
</html>
