<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ø£Ø³Ø·ÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø¯ ÙˆÙƒÙ†ÙˆØ² NFT</title>
    <style>
        body { margin: 0; overflow: hidden; background: #2d5a27; touch-action: none; font-family: sans-serif; }
        #world { position: relative; width: 100vw; height: 100vh; background: #3d7038; }
        
        /* Ø§Ù„Ø´Ø®ØµÙŠØ§Øª */
        #character { position: absolute; font-size: 60px; z-index: 100; transition: all 0.1s ease-out; pointer-events: none; }
        .item { position: absolute; font-size: 40px; z-index: 50; transition: all 0.3s; }
        .tree { position: absolute; font-size: 50px; z-index: 40; opacity: 0.8; }
        
        /* Ø§Ù„Ø¨ÙŠØ¦Ø© */
        #lake { position: absolute; bottom: 0; left: 0; width: 200px; height: 200px; background: rgba(30, 144, 255, 0.6); border-radius: 0 100% 0 0; border: 4px solid white; z-index: 10; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; }
        
        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
        #hud { position: fixed; top: 10px; width: 100%; display: flex; justify-content: space-around; color: white; z-index: 1000; background: rgba(0,0,0,0.3); padding: 5px; }
        #owl { position: fixed; bottom: 20px; right: 20px; font-size: 55px; z-index: 1001; cursor: pointer; filter: drop-shadow(2px 2px 5px black); }
        .digging { filter: contrast(150%) brightness(50%); transform: scale(0.6) !important; }
        
        /* Ø±Ø³Ø§Ù„Ø© NFT */
        #nft-msg { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); color: gold; font-size: 24px; display: none; z-index: 2000; background: rgba(0,0,0,0.8); padding: 20px; border-radius: 15px; border: 2px solid gold; text-align: center; }
    </style>
</head>
<body>

<div id="hud">
    <div>ğŸ’°: <span id="coins">0</span></div>
    <div>ğŸ§¬: <span id="level">Ø´Ø¨Ù„</span></div>
    <div id="hStatus">ğŸ¹ Ø§Ù„ØµÙŠØ§Ø¯: Ù†Ø§Ø¦Ù…</div>
</div>

<div id="nft-msg">âœ¨ ÙˆØ¬Ø¯Øª Ø´Ø¸ÙŠØ© NFT Ù†Ø§Ø¯Ø±Ø©! âœ¨<br>Ø§Ù„Ø¨ÙˆÙ…Ø© ØªØ¹Ù„Ù…Ùƒ Ø³Ø± Ø§Ù„ÙƒÙ†ÙˆØ² Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</div>

<div id="world">
    <div id="lake">ğŸŒŠ Ù…Ù†Ø·Ù‚Ø© Ø¢Ù…Ù†Ø©</div>
    <div id="character">ğŸ¦</div>
    <div id="hunter" class="item" style="display:none;">ğŸ•µï¸â€â™‚ï¸</div>
    <div id="prey" class="item">ğŸ‡</div>
    <div id="chameleon" class="item">ğŸ¦</div>
    
    <div class="tree" style="top:10%; left:10%;">ğŸŒ³</div>
    <div class="tree" style="top:20%; left:70%;">ğŸŒ²</div>
    <div class="tree" style="top:60%; left:40%;">ğŸŒ³</div>
    <div class="tree" style="top:80%; left:80%;">ğŸŒ²</div>
</div>

<div id="owl" title="Ø§Ø¶ØºØ· Ù„Ù„Ø­ÙØ±">ğŸ¦‰</div>

<script>
    const char = document.getElementById('character');
    const coinsTxt = document.getElementById('coins');
    const levelTxt = document.getElementById('level');
    const hunter = document.getElementById('hunter');
    const owl = document.getElementById('owl');
    const nftMsg = document.getElementById('nft-msg');
    
    let coins = 0;
    let speedMult = 0.15; // Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
    let isDigging = false;
    let evolution = 0; // 0 Ø´Ø¨Ù„ØŒ 1 Ø´Ø§Ø¨ØŒ 2 Ø£Ø³Ø¯

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø±ÙƒØ© (Ù…Ø¹ Ù…ÙŠØ²Ø© Ø§Ù„ØªØ¨Ø·ÙŠØ¦ Ø§Ù„ÙØ¹Ù„ÙŠ) ---
    document.body.addEventListener('touchmove', (e) => {
        if (isDigging) return;
        e.preventDefault();
        let t = e.touches[0];
        
        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ© Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„ØªØ¨Ø·ÙŠØ¦
        let targetX = t.clientX;
        let targetY = t.clientY;
        let currX = char.offsetLeft + 30;
        let currY = char.offsetTop + 30;

        // Ø§Ù„ØªØ­Ø±ÙŠÙƒ Ø¨Ù†Ø³Ø¨Ø© SpeedMult (Ù„Ùˆ Ù„Ù…Ø³ Ø§Ù„Ø­Ø±Ø¨Ø§Ø¡ ØªÙ‚Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙŠÙ…Ø©)
        char.style.left = currX + (targetX - currX) * speedMult + 'px';
        char.style.top = currY + (targetY - currY) * speedMult + 'px';
        
        checkCollisions();
    }, { passive: false });

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµØ§Ø¯Ù… ---
    function checkCollisions() {
        let charRect = char.getBoundingClientRect();
        let prey = document.getElementById('prey');
        let cham = document.getElementById('chameleon');

        // ØµÙŠØ¯ Ø§Ù„ÙØ±ÙŠØ³Ø© (Ø§Ù„Ø§ÙØªØ±Ø§Ø³)
        if (isHit(charRect, prey.getBoundingClientRect())) {
            let bonus = (evolution + 1) * 10;
            coins += bonus;
            if(evolution === 2) { // Ù„Ùˆ Ø£Ø³Ø¯ ÙŠÙ‚Ø¶ÙŠ Ø¹Ù„ÙŠÙ‡
                prey.style.transform = "scale(0)";
                setTimeout(() => { prey.style.transform = "scale(1)"; spawn(prey); }, 500);
            } else {
                spawn(prey);
            }
            updateGame();
        }

        // Ø§Ù„Ø­Ø±Ø¨Ø§Ø¡ (ØªØ¨Ø·Ø¦ Ø§Ù„Ø­Ø±ÙƒØ© Ø¬Ø¯Ø§Ù‹)
        if (isHit(charRect, cham.getBoundingClientRect())) {
            speedMult = 0.02; // ØªØ¨Ø·Ø¦ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©
            char.style.filter = "sepia(1) blur(1px)";
            setTimeout(() => { 
                speedMult = 0.15; 
                char.style.filter = "none"; 
            }, 5000);
            spawn(cham);
        }
    }

    function isHit(r1, r2) {
        return !(r1.right < r2.left || r1.left > r2.right || r1.bottom < r2.top || r1.top > r2.bottom);
    }

    function spawn(el) {
        el.style.left = Math.random() * 80 + 'vw';
        el.style.top = Math.random() * 80 + 'vh';
    }

    function updateGame() {
        coinsTxt.innerText = coins;
        if (coins >= 50 && evolution === 0) { 
            evolution = 1; levelTxt.innerText = "Ø´Ø§Ø¨"; char.innerText = "ğŸ†"; 
        }
        if (coins >= 150 && evolution === 1) { 
            evolution = 2; levelTxt.innerText = "Ø£Ø³Ø¯ Ù…Ù„Ùƒ"; char.innerText = "ğŸ¦"; 
            char.style.fontSize = "85px";
        }
    }

    // --- Ø£Ù…Ø± Ø§Ù„Ø¨ÙˆÙ…Ø© (Ø§Ù„Ø­ÙØ± ÙˆÙƒÙ†ÙˆØ² NFT) ---
    owl.onclick = () => {
        if (isDigging) return;
        isDigging = true;
        char.classList.add('digging');
        
        // Ø§Ù„Ø¨ÙˆÙ…Ø© ØªØ¹Ù„Ù…Ù‡
        nftMsg.style.display = "block";
        nftMsg.innerHTML = "ğŸ¦‰ Ø§Ù„Ø¨ÙˆÙ…Ø© ØªØ±Ø´Ø¯Ùƒ Ù„Ø¹Ù…Ù‚ Ø§Ù„Ø£Ø±Ø¶...<br>Ø§Ù†ØªØ¸Ø± 15 Ø«Ø§Ù†ÙŠØ© Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¸Ø§ÙŠØ§ NFT";

        setTimeout(() => {
            isDigging = false;
            char.classList.remove('digging');
            nftMsg.innerHTML = "âœ¨ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ø´Ø¸ÙŠØ© NFT Ø±Ù‚Ù…ÙŠØ©! âœ¨<br>Ù‚ÙŠÙ…ØªÙ‡Ø§: 50 Ø¹Ù…Ù„Ø©";
            coins += 50;
            updateGame();
            setTimeout(() => nftMsg.style.display = "none", 3000);
        }, 15000);
    };

    // --- Ø§Ù„ØµÙŠØ§Ø¯ ÙˆØ§Ù„Ø¨Ø­ÙŠØ±Ø© Ø§Ù„Ø¢Ù…Ù†Ø© ---
    setInterval(() => {
        let active = Math.random() > 0.4;
        hunter.style.display = active ? 'block' : 'none';
        document.getElementById('hStatus').innerText = active ? "ğŸ¹ Ø§Ù„ØµÙŠØ§Ø¯: ÙŠØ·Ø§Ø±Ø¯Ùƒ!" : "ğŸ¹ Ø§Ù„ØµÙŠØ§Ø¯: Ù†Ø§Ø¦Ù…";
        if(active) spawn(hunter);
    }, 12000);

    setInterval(() => {
        if (hunter.style.display === 'block' && !isDigging) {
            let hX = hunter.offsetLeft, hY = hunter.offsetTop;
            let cX = char.offsetLeft, cY = char.offsetTop;

            // ÙØ­Øµ Ø§Ù„Ø¨Ø­ÙŠØ±Ø© (Ù…Ù†Ø·Ù‚Ø© Ø¢Ù…Ù†Ø©)
            const inLake = (cX < 200 && cY > (window.innerHeight - 200));

            if (!inLake) {
                hunter.style.left = hX + (cX - hX) * 0.03 + 'px';
                hunter.style.top = hY + (cY - hY) * 0.03 + 'px';
                
                if(isHit(char.getBoundingClientRect(), hunter.getBoundingClientRect())) {
                    coins = Math.max(0, coins - 2);
                    coinsTxt.innerText = coins;
                }
            } else {
                // Ø§Ù„ØµÙŠØ§Ø¯ ÙŠÙ‡Ø±Ø¨ Ø¨Ø¹ÙŠØ¯Ø§Ù‹ Ø¹Ù† Ø§Ù„Ù…Ø§Ø¡
                hunter.style.left = hX + 5 + 'px';
            }
        }
    }, 50);

    spawn(document.getElementById('prey'));
    spawn(document.getElementById('chameleon'));
</script>

</body>
</html>
